<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>core_demo - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201605101153170700-ecbec5879e34c7cbc28283a2045353a80cbf92c8/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201605101153170700-ecbec5879e34c7cbc28283a2045353a80cbf92c8/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201605101153170700-ecbec5879e34c7cbc28283a2045353a80cbf92c8/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201605101153170700-ecbec5879e34c7cbc28283a2045353a80cbf92c8/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201605101153170700-ecbec5879e34c7cbc28283a2045353a80cbf92c8/img/favicon.ico"/>
<script>window.settings = {"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","workspaceFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/databricks_guide/index.html","displayName":"Databricks Guide","icon":"question"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/sample_applications/index.html","displayName":"Application Examples","icon":"code"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/courses/index.html","displayName":"Training","icon":"graduation-cap"}],"dbcForumURL":"http://forums.databricks.com/","nodeInfo":{"node_types":[{"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":3.0,"node_type_id":"dev-tier-node","description":"Community Optimized","container_memory_mb":6000,"memory_mb":6144,"num_cores":0.88}],"default_node_type_id":"dev-tier-node"},"enableThirdPartyApplicationsUI":false,"enableClusterAcls":false,"notebookRevisionVisibilityHorizon":6,"enableTableHandler":true,"isAdmin":true,"enableLargeResultDownload":true,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enablePublishNotebooks":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"clusters":true,"allowRunOnPendingClusters":true,"applications":false,"fileStoreBase":"FileStore","configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableResetPassword":true,"enableJobsSparkUpgrade":true,"sparkVersions":[{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-1.6.1-hadoop1-jenkins-ip-10-30-10-144-Uecbec5879e-S2368283920-2016-05-10-19:12:50.761403","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-1.4-jenkins-ip-10-30-10-144-Uecbec5879e-S9c254ab12a-2016-05-10-19:12:50.761403","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"master","displayName":"Spark master (dev)","packageLabel":"","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-1.6.1-hadoop1-jenkins-ip-10-30-10-144-Uecbec5879e-S2368283920-2016-05-10-19:12:50.761403","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-1.6.1-hadoop1-jenkins-ip-10-30-10-144-Uecbec5879e-S2368283920-2016-05-10-19:12:50.761403","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-1.6.1-hadoop2-jenkins-ip-10-30-10-144-Uecbec5879e-S2368283920-2016-05-10-19:12:50.761403","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-1.5-jenkins-ip-10-30-10-144-Uecbec5879e-S9ca52d000d-2016-05-10-19:12:50.761403","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-1.3-jenkins-ip-10-30-10-144-Uecbec5879e-Sa2ee4664b2-2016-05-10-19:12:50.761403","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (branch preview)","packageLabel":"spark-image-9a9663cc79bbcb0874f187d159c1f7fb78ab750b3ef14472f179325814f22443","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-1.6.0-jenkins-ip-10-30-10-144-Uecbec5879e-Sf90f83597b-2016-05-10-19:12:50.761403","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-1.6.1-hadoop2-jenkins-ip-10-30-10-144-Uecbec5879e-S2368283920-2016-05-10-19:12:50.761403","upgradable":true,"deprecated":false,"customerVisible":false}],"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"driverStdoutFilePrefix":"stdout","enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableNotebookHistoryDiffing":true,"branch":"2.19.1","accountsLimit":3,"enableNotebookGitBranching":true,"local":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"deploymentMode":"production","useSpotForWorkers":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"enableCssTransitions":true,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"notifyLastLogin":false,"enableNotebookGitVersioning":true,"files":"files/","enableDriverLogsUI":true,"disableLegacyDashboards":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":4096,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":false,"enableMavenLibraries":true,"displayRowLimit":1000,"defaultSparkVersion":{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-1.6.1-hadoop1-jenkins-ip-10-30-10-144-Uecbec5879e-S2368283920-2016-05-10-19:12:50.761403","upgradable":true,"deprecated":false,"customerVisible":true},"enableMountAclsConfig":false,"enableClusterAclsByTier":false,"disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"logfiles":"logfiles/","enableWebappSharding":false,"enableClusterDeltaUpdates":true,"useFixedStaticNotebookVersionForDevelopment":false,"enableMountAcls":false,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"enableWorkspaceAclService":true,"enableWorkspaceAcls":false,"gitHash":"ecbec5879e34c7cbc28283a2045353a80cbf92c8","showWorkspaceFeaturedLinks":true,"allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"showDevTierBetaVersion":true,"enableDebugUI":false,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/201605101153170700-ecbec5879e34c7cbc28283a2045353a80cbf92c8/","enableSparkPackages":true,"dynamicSparkVersions":true,"enableNotebookHistoryUI":true,"showDebugCounters":false,"enableFolderHtmlExport":true,"enableSparkVersionsUI":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/1%20QuickStart%20Notebooks%20(Python).html","displayName":"Getting Started","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/3%20QuickStart%20DataFrames%20(Scala).html","displayName":"Introduction to DataFrames","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/DecisionTrees-Example.html","displayName":"Decision Trees in Spark","icon":"img/home/Scala_icon.svg"}],"upgradeURL":"https://accounts.cloud.databricks.com/registration.html","notebookLoadingBackground":"#fff","enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableTerminal":false,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"accounts":true,"useFramedStaticNotebooks":true,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":3517203864005901,"name":"core_demo","language":"scala","commands":[{"version":"CommandV1","origId":3517203864005903,"guid":"f86c69e8-9d95-437c-abdb-e5455ffbb774","subtype":"command","commandType":"auto","position":0.015625,"command":"%md \n<h1>Jump Start Spark<h1>\nPart 2 - Spark Core - Transformations and Actions","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":true,"iPythonMetadata":null,"nuid":"6ab60fc6-280d-4b1c-8502-07459952f9be"},{"version":"CommandV1","origId":3517203864005969,"guid":"71e8b155-c2b2-4098-9cad-60e2553d944f","subtype":"command","commandType":"auto","position":0.0390625,"command":"%md <pre>\nTable of Contents\n1) Examine the data\n2) Filter the data\n3) Parse the data to RDD\n4) Persistence\n5) Count some data\n6) Key, Value pairs</pre>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"890fc9ea-d7c0-4298-8582-e6ac50edfff2"},{"version":"CommandV1","origId":3517203864005905,"guid":"445afbb8-4bc4-4ac8-83db-b1b347eb8274","subtype":"command","commandType":"auto","position":0.0625,"command":"%md ### 1) Examine the data","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b827b017-31ab-4181-a2eb-ed6f30ebc68a"},{"version":"CommandV1","origId":700282690933870,"guid":"f7f28aa5-522a-44b8-9dd0-bbb379345a7e","subtype":"command","commandType":"auto","position":0.078125,"command":"%fs ls /databricks-datasets/","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dbfs:/databricks-datasets/README.md","README.md",976.0],["dbfs:/databricks-datasets/Rdatasets/","Rdatasets/",0.0],["dbfs:/databricks-datasets/SPARK_README.md","SPARK_README.md",3359.0],["dbfs:/databricks-datasets/adult/","adult/",0.0],["dbfs:/databricks-datasets/airlines/","airlines/",0.0],["dbfs:/databricks-datasets/amazon/","amazon/",0.0],["dbfs:/databricks-datasets/asa/","asa/",0.0],["dbfs:/databricks-datasets/bikeSharing/","bikeSharing/",0.0],["dbfs:/databricks-datasets/cs100/","cs100/",0.0],["dbfs:/databricks-datasets/cs190/","cs190/",0.0],["dbfs:/databricks-datasets/data.gov/","data.gov/",0.0],["dbfs:/databricks-datasets/flights/","flights/",0.0],["dbfs:/databricks-datasets/learning-spark/","learning-spark/",0.0],["dbfs:/databricks-datasets/mnist-digits/","mnist-digits/",0.0],["dbfs:/databricks-datasets/news20.binary/","news20.binary/",0.0],["dbfs:/databricks-datasets/power-plant/","power-plant/",0.0],["dbfs:/databricks-datasets/sample_logs/","sample_logs/",0.0],["dbfs:/databricks-datasets/samples/","samples/",0.0],["dbfs:/databricks-datasets/sms_spam_collection/","sms_spam_collection/",0.0],["dbfs:/databricks-datasets/songs/","songs/",0.0],["dbfs:/databricks-datasets/tpch/","tpch/",0.0],["dbfs:/databricks-datasets/wiki/","wiki/",0.0],["dbfs:/databricks-datasets/wikipedia-datasets/","wikipedia-datasets/",0.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\""},{"name":"name","type":"\"string\""},{"name":"size","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1.463107949903E12,"submitTime":1.463107942016E12,"finishTime":1.463107952844E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"30ac06c6-1097-42cc-a971-523f451196a4"},{"version":"CommandV1","origId":3517203864005904,"guid":"0de441e8-fef5-4d4f-a5c3-0fc33d565883","subtype":"command","commandType":"auto","position":0.09375,"command":"%fs ls /databricks-datasets/bikeSharing/data-001","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dbfs:/databricks-datasets/bikeSharing/data-001/day.csv","day.csv",57569.0],["dbfs:/databricks-datasets/bikeSharing/data-001/hour.csv","hour.csv",1156736.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\""},{"name":"name","type":"\"string\""},{"name":"size","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"java.io.FileNotFoundException: /databricks-datasets/amazon/data20k","error":null,"workflows":[],"startTime":1.462916488507E12,"submitTime":1.462916477171E12,"finishTime":1.46291649706E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1187","height":"120","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"558a4b2b-69e1-4031-911e-b47d5d0791ea"},{"version":"CommandV1","origId":3517203864005906,"guid":"e7265f1a-85fc-4fa6-8cfe-44d62a3a15c7","subtype":"command","commandType":"auto","position":0.25,"command":"val bikeRDD = sc.textFile(\"/databricks-datasets/bikeSharing/data-001/hour.csv\",4)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">bikeRDD: org.apache.spark.rdd.RDD[String] = /databricks-datasets/bikeSharing/data-001/hour.csv MapPartitionsRDD[1404] at textFile at &lt;console&gt;:32\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.463108027045E12,"submitTime":1.46310801916E12,"finishTime":1.463108027155E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"5b8ebd8f-d250-4b48-828b-786f83ef65b2"},{"version":"CommandV1","origId":3517203864005907,"guid":"2e67c3f9-c60e-46fb-b999-526921955b3e","subtype":"command","commandType":"auto","position":0.40625,"command":"bikeRDD.take(5).foreach(println)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">instant,dteday,season,yr,mnth,hr,holiday,weekday,workingday,weathersit,temp,atemp,hum,windspeed,casual,registered,cnt\n1,2011-01-01,1,0,1,0,0,6,0,1,0.24,0.2879,0.81,0,3,13,16\n2,2011-01-01,1,0,1,1,0,6,0,1,0.22,0.2727,0.8,0,8,32,40\n3,2011-01-01,1,0,1,2,0,6,0,1,0.22,0.2727,0.8,0,5,27,32\n4,2011-01-01,1,0,1,3,0,6,0,1,0.24,0.2879,0.75,0,3,10,13\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.463108029632E12,"submitTime":1.463108021744E12,"finishTime":1.463108029941E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"207a0779-e97f-4c14-b192-cb65bfe6d69a"},{"version":"CommandV1","origId":3517203864005908,"guid":"24b3471c-ce78-4380-8d28-66c304108201","subtype":"command","commandType":"auto","position":0.41015625,"command":"%md ### 2) Filter out the header line","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4a8d4e38-5bbc-4c6a-8273-a90c6df4b3b0"},{"version":"CommandV1","origId":3517203864005909,"guid":"87e4e944-ac9d-43df-b916-d62512f734ad","subtype":"command","commandType":"auto","position":0.4140625,"command":"def isHeader(line: String): Boolean = {\n line.contains(\"instant\")\n}\nval noHeaderBikeRDD = bikeRDD.filter(x => !isHeader(x))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">isHeader: (line: String)Boolean\nnoHeaderBikeRDD: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[1444] at filter at &lt;console&gt;:37\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.463108222109E12,"submitTime":1.463108214215E12,"finishTime":1.463108222175E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d429912e-e51c-4588-9240-850df310515c"},{"version":"CommandV1","origId":3517203864005915,"guid":"9a9b14cd-afd8-4f02-a98c-a0b02e27d390","subtype":"command","commandType":"auto","position":0.421875,"command":"%md ### 3) Parse the data \n\nSpark sends the code to the data, not the data to the code.</h4> \nWhen we use a method in a spark operation (like map), that method and its dependencies are packaged and sent out to all the workers.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"89276609-c7f2-4ae0-8dec-1406b8375bdb"},{"version":"CommandV1","origId":3517203864005913,"guid":"77eeedaa-3b15-4693-928e-b07cd4d03cf0","subtype":"command","commandType":"auto","position":0.43035888671875,"command":"//case class are scala objects which are automatically serializable\ncase class BikeData(date: String, season: String, temp: Double, casual: Integer, registered: Integer, counts: Integer)\n\ndef seasonNames(x: String): String = x match {\n    case \"1\" => \"winter\"\n    case \"2\" => \"spring\"\n    case \"3\" => \"summer\"\n    case \"4\" => \"fall\"\n  }\n\ndef parse(line: String) = {\n val pieces = line.split(',')\n val date = pieces(1).toString\n val season = seasonNames(pieces(2)) \n val temp = pieces(10).toDouble\n val casual = pieces(14).toInt\n val registered = pieces(15).toInt\n val counts = pieces(16).toInt\n BikeData(date, season, temp, casual, registered, counts)\n}\n\nval parsedBikeRDD = noHeaderBikeRDD.map(line => parse(line))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class BikeData\nseasonNames: (x: String)String\nparse: (line: String)BikeData\nparsedBikeRDD: org.apache.spark.rdd.RDD[BikeData] = MapPartitionsRDD[1448] at map at &lt;console&gt;:59\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:2: error: identifier expected but ':' found.\n       case class BikeData(date: String, season: String, temp: Double, casual: Integer, registered: Integer counts: Integer)\n                                                                                                                  ^\n</div>","error":null,"workflows":[],"startTime":1.463108236516E12,"submitTime":1.463108228618E12,"finishTime":1.463108236728E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"1e27ad15-99a6-419e-ae79-8aeb7905b557"},{"version":"CommandV1","origId":3517203864005918,"guid":"12c8638a-2a2d-486d-91a3-e90857b2f8b3","subtype":"command","commandType":"auto","position":0.430450439453125,"command":"//check out the DAG for our RDD\nparsedBikeRDD.toDebugString","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res2: String = \n(4) MapPartitionsRDD[1448] at map at &lt;console&gt;:59 []\n |  MapPartitionsRDD[1444] at filter at &lt;console&gt;:37 []\n |  /databricks-datasets/bikeSharing/data-001/hour.csv MapPartitionsRDD[1404] at textFile at &lt;console&gt;:32 []\n |  /databricks-datasets/bikeSharing/data-001/hour.csv HadoopRDD[1403] at textFile at &lt;console&gt;:32 []\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.463108239245E12,"submitTime":1.463108231348E12,"finishTime":1.463108239311E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"43754e49-11aa-409b-bff7-393b9a619af0"},{"version":"CommandV1","origId":3517203864005962,"guid":"0ea9d0fd-fe6f-4ab6-a77e-b609ed18f161","subtype":"command","commandType":"auto","position":0.4304962158203125,"command":"%md ### 4) Persistence Persistence Persistence","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"9e7bc497-2fb3-4368-9d6d-5225822fef8a"},{"version":"CommandV1","origId":3517203864005922,"guid":"91c44fdb-a98a-448e-a154-faf81eaa0310","subtype":"command","commandType":"auto","position":0.430908203125,"command":"//cache() is a transformation, our RDD wont be cached until it is materialized by the next action. \n//lets see how long it takes to count our data before it is cached in memory\nparsedBikeRDD.cache.count","commandVersion":0,"state":"error","results":null,"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.463108257024E12,"submitTime":1.463108257024E12,"finishTime":1.463109115932E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8f2db038-210a-447e-a987-91ab0928d034"},{"version":"CommandV1","origId":3517203864005921,"guid":"21c48e6a-48ef-4008-af61-c2ffd8ba9a04","subtype":"command","commandType":"auto","position":0.431365966796875,"command":"//now we see that the DAG includes \"[Memory Deserialized 1x Replicated]\"\nparsedBikeRDD.toDebugString","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res7: String = \n(4) MapPartitionsRDD[33] at map at &lt;console&gt;:59 [Memory Deserialized 1x Replicated]\n |       CachedPartitions: 3; MemorySize: 400.7 MB; ExternalBlockStoreSize: 0.0 B; DiskSize: 0.0 B\n |  MapPartitionsRDD[31] at filter at &lt;console&gt;:37 [Memory Deserialized 1x Replicated]\n |  /databricks-datasets/bikeSharing/data-001/hour.csv MapPartitionsRDD[29] at textFile at &lt;console&gt;:32 [Memory Deserialized 1x Replicated]\n |  /databricks-datasets/bikeSharing/data-001/hour.csv HadoopRDD[28] at textFile at &lt;console&gt;:32 [Memory Deserialized 1x Replicated]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.462916848587E12,"submitTime":1.462916837532E12,"finishTime":1.462916848686E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"fc763969-524c-4999-b47f-7c5d5ec1ca34"},{"version":"CommandV1","origId":3517203864005963,"guid":"4cd57300-26d5-40fa-8cd6-8e6a73ea3fb5","subtype":"command","commandType":"auto","position":0.4314117431640625,"command":"//if we count again, our data is in memory\nparsedBikeRDD.count()","commandVersion":0,"state":"error","results":null,"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.463108589848E12,"submitTime":1.463108589848E12,"finishTime":1.463108591863E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"40fe39fa-df62-4bcf-b6b5-dea8527662ca"},{"version":"CommandV1","origId":3517203864005929,"guid":"4bc5c14f-890e-44b8-9962-808af0bc5703","subtype":"command","commandType":"auto","position":0.4409475326538086,"command":"%md ### 5) Count some data","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"2717bc49-6072-4bfb-a376-184800a7f7ba"},{"version":"CommandV1","origId":3517203864005930,"guid":"e429440d-b027-4f1b-82d4-26c3bd51da5c","subtype":"command","commandType":"auto","position":0.4426136016845703,"command":"val total_counts = parsedBikeRDD.map(bd => bd.counts).reduce((a,b) => a + b )\nval total_casual = parsedBikeRDD.map(bd => bd.casual).reduce((a,b) => a + b )\nval total_registered = parsedBikeRDD.map(bd => bd.registered).reduce((a,b) => a + b )","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">total_counts: Integer = 3292679\ntotal_casual: Integer = 620017\ntotal_registered: Integer = 2672662\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.458364131603E12,"submitTime":1.458364123428E12,"finishTime":1.458364132106E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"1796cdf1-6752-4ba8-89af-11510c9b3dcb"},{"version":"CommandV1","origId":3517203864005931,"guid":"f470c4f9-bad2-4215-9132-db7d908d3851","subtype":"command","commandType":"auto","position":0.44594573974609375,"command":"%md #### stats() returns a class containing the count, mean, stdev, max, min of an RDD[Doubles]","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"5d0ff784-cd16-41d8-a86b-9a2de2a20e51"},{"version":"CommandV1","origId":3517203864005932,"guid":"90b06ff5-00b5-4731-bf54-26a3a8cc3e0d","subtype":"command","commandType":"auto","position":0.4596390724182129,"command":"val temperature_stats = parsedBikeRDD.map(bd => bd.temp).stats()\nval counts_stats = parsedBikeRDD.map(bd => bd.counts.toDouble).stats()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">temperature_stats: org.apache.spark.util.StatCounter = (count: 17379, mean: 0.496987, stdev: 0.192551, max: 1.000000, min: 0.020000)\ncounts_stats: org.apache.spark.util.StatCounter = (count: 17379, mean: 189.463088, stdev: 181.382380, max: 977.000000, min: 1.000000)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:45: error: could not find implicit value for parameter num: Numeric[Integer]\n       val counts_stats = parsedBikeRDD.map(bd =&gt; bd.counts).stats()\n                                           ^\n</div>","error":null,"workflows":[],"startTime":1.45836458527E12,"submitTime":1.458364577092E12,"finishTime":1.458364585505E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d9d7f2bc-ed3f-4094-822f-c6aab0cce1c0"},{"version":"CommandV1","origId":3517203864005968,"guid":"3d0cfcd8-f91a-443c-bfad-323fb27eac78","subtype":"command","commandType":"auto","position":0.45984578132629395,"command":"%md ### 6) Key, Value pairs","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b646d491-6b6d-48e2-bf56-05a4d6c0539c"},{"version":"CommandV1","origId":3517203864005933,"guid":"d0eccb40-4c41-4126-93b9-28a510d2bc17","subtype":"command","commandType":"auto","position":0.460052490234375,"command":"%md\nWe want to calculate the count per season in our data, and the number of days in the season, in order to calculate the daily average per season.  \nWe will use one of the aggregation methods for PairedRDDs\n\n* combineByKey() -- Has map-side combine. is used when return type from the aggregation is different from the values being aggregated (for example, running averages). It takes 3 functions:\ncreateCombiner()\nmergeValue()\nmergeCombiner()\n\n* reduceByKey()  -- Has map-side combine. Is sort of a particular convenient case of aggregateByKey.\n\n* groupByKey -- No map-side combine. Expensive.\n\n\n\n\n","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.457939205521E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b9f4f31b-64a9-484f-a1fa-95cfb6f30a4f"},{"version":"CommandV1","origId":3517203864005934,"guid":"8e836c51-eff3-43ab-8b6e-4a4eb3f211a3","subtype":"command","commandType":"auto","position":0.4608306884765625,"command":"//make a key value pair\nval countRDD = parsedBikeRDD.map(line=>(line.season, (line.counts, 1)))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">countRDD: org.apache.spark.rdd.RDD[(String, (Integer, Int))] = MapPartitionsRDD[290] at map at &lt;console&gt;:47\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:45: error: value count is not a member of BikeData\n       val countsDF = parsedBikeRDD.map(bd =&gt; Tuple2(bd.season,bd.count))\n                                                                  ^\n</div>","error":null,"workflows":[],"startTime":1.462917855193E12,"submitTime":1.462917844145E12,"finishTime":1.462917855338E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"2e761b4f-6fd0-46fc-a946-ad9b18aaaf33"},{"version":"CommandV1","origId":3517203864005935,"guid":"b9880efd-6944-4e67-91bb-48dac3a2b489","subtype":"command","commandType":"auto","position":0.46160888671875,"command":"val seasonalCountsTotals = countRDD.reduceByKey{ case (x,y) => (x._1 + y._1, x._2 + y._2) }","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">seasonalCountsTotals: org.apache.spark.rdd.RDD[(String, (Integer, Int))] = ShuffledRDD[292] at reduceByKey at &lt;console&gt;:48\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:50: error: type mismatch;\n found   : Double\n required: String\n       (acc: (Any,Int), v) =&gt; (acc._1 + v, acc._2 + 1),\n                                        ^\n</div>","error":null,"workflows":[],"startTime":1.462917856441E12,"submitTime":1.462917845395E12,"finishTime":1.462917856666E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a6695af6-fd0e-4ecc-8f5f-b89c0072adf2"},{"version":"CommandV1","origId":3517203864005936,"guid":"f32138a1-50af-4909-8a97-baa172755a1e","subtype":"command","commandType":"auto","position":0.472503662109375,"command":"seasonalCountsTotals.collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res11: Array[(String, (Integer, Int))] = Array((winter,(471348,4242)), (spring,(918589,4409)), (summer,(1061129,4496)), (fall,(841613,4232)))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.462917859626E12,"submitTime":1.462917848582E12,"finishTime":1.462917859857E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"564add9f-1a9d-4a7e-b23b-93ab853f0e99"},{"version":"CommandV1","origId":3517203864005966,"guid":"f2763759-2cb5-4834-b91d-1930e225988a","subtype":"command","commandType":"auto","position":0.4857978820800781,"command":"val dailyAverage = seasonalCountsTotals.mapValues{case (total, days) => total/days }\ndailyAverage.collect","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">dailyAverage: org.apache.spark.rdd.RDD[(String, Int)] = MapPartitionsRDD[294] at mapValues at &lt;console&gt;:57\nres12: Array[(String, Int)] = Array((winter,111), (spring,208), (summer,236), (fall,198))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:2: error: illegal start of simple expression\n       val dailyAverage = seasonalCountsTotals.mapValues( (x,y) =&gt; case (counts, days) = counts/days)\n                                                                   ^\n</div>","error":null,"workflows":[],"startTime":1.462917865474E12,"submitTime":1.462917854403E12,"finishTime":1.462917865681E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"02e539c2-f326-4eee-b2ed-7ccd67245000"}],"dashboards":[{"version":"DashboardViewV1","origId":3517203864005956,"guid":"6378c9fc-4ea0-4cd5-8254-4479872180cf","nuid":"1f7d6bb9-f8d2-4378-b7e4-2280dee99efa","title":"Untitled","width":1024,"layoutOption":{"stack":true,"grid":true},"elements":[{"guid":"02ad3613-2314-4dfd-9f48-dd209f6dd31b","elementType":"command","elementNUID":"558a4b2b-69e1-4031-911e-b47d5d0791ea","position":null,"options":null},{"guid":"8be93aa2-b8d1-4977-b09a-533c503d79b0","elementType":"command","elementNUID":"4a8d4e38-5bbc-4c6a-8273-a90c6df4b3b0","position":null,"options":null},{"guid":"f1cedb6d-9a08-4e74-9cd4-a1a1a4d6e3a9","elementType":"command","elementNUID":"5d0ff784-cd16-41d8-a86b-9a2de2a20e51","position":null,"options":null},{"guid":"a54ace54-a930-46d6-a221-6ba259f2656a","elementType":"command","elementNUID":"b9f4f31b-64a9-484f-a1fa-95cfb6f30a4f","position":null,"options":null}],"globalVars":{}}],"guid":"2cbf8e50-0963-4a44-acfe-7509bb63266a","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/201605101153170700-ecbec5879e34c7cbc28283a2045353a80cbf92c8/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
<script>var tableOfContentsCell = {"version":"CommandV1","origId":-1,"guid":"7c1094cc-5e17-4d1a-8d6a-1f35c09d3f13","subtype":"command","commandType":"auto","position":0.0,"command":"%md [&lsaquo; Back to Table of Contents](index.html)","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null};</script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/201605101153170700-ecbec5879e34c7cbc28283a2045353a80cbf92c8/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>